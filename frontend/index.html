<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Norman's Email Trash Hauling</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Critical CSS for instant loading screen -->
    <style>
      /* Instant loading screen - no JS required */
      :root {
        --emerald-500: #10b981;
        --emerald-400: #34d399;
        --emerald-600: #059669;
      }

      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(180deg, #f0fdf4 0%, #dcfce7 50%, #d1fae5 100%);
        min-height: 100vh;
      }

      #initial-loader {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.3s ease-out;
      }

      #initial-loader.fade-out {
        opacity: 0;
        pointer-events: none;
      }

      .loader-scene {
        position: relative;
        width: 320px;
        height: 160px;
      }

      /* Road */
      .loader-road {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 32px;
        background: linear-gradient(180deg, #374151 0%, #1f2937 100%);
        border-radius: 8px;
        overflow: hidden;
      }

      .loader-road::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 3px;
        transform: translateY(-50%);
        background: repeating-linear-gradient(90deg, #fbbf24 0px, #fbbf24 20px, transparent 20px, transparent 40px);
        animation: road-scroll 0.5s linear infinite;
      }

      @keyframes road-scroll {
        from { transform: translateY(-50%) translateX(0); }
        to { transform: translateY(-50%) translateX(-40px); }
      }

      /* Grass */
      .loader-grass {
        position: absolute;
        bottom: 32px;
        left: 0;
        right: 0;
        height: 20px;
        background: linear-gradient(180deg, #22c55e 0%, #16a34a 100%);
        border-radius: 8px 8px 0 0;
      }

      /* Truck container */
      .loader-truck-container {
        position: absolute;
        bottom: 20px;
        animation: truck-drive 4s ease-in-out infinite;
      }

      @keyframes truck-drive {
        0%, 100% { left: -80px; }
        50% { left: calc(100% - 20px); }
      }

      /* Truck bounce */
      .loader-truck {
        animation: truck-bounce 0.4s ease-in-out infinite;
      }

      @keyframes truck-bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-2px); }
      }

      /* Wheel spin */
      .wheel {
        animation: wheel-spin 0.3s linear infinite;
        transform-origin: center;
      }

      @keyframes wheel-spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      /* Exhaust */
      .exhaust {
        animation: puff 1s ease-out infinite;
        opacity: 0;
      }

      .exhaust:nth-child(2) { animation-delay: 0.3s; }
      .exhaust:nth-child(3) { animation-delay: 0.6s; }

      @keyframes puff {
        0% { opacity: 0.6; transform: translate(0, 0) scale(0.5); }
        100% { opacity: 0; transform: translate(-20px, -15px) scale(1.5); }
      }

      /* Text */
      .loader-text {
        margin-top: 32px;
        text-align: center;
      }

      .loader-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1f2937;
        margin: 0 0 8px 0;
      }

      .loader-subtitle {
        font-size: 0.875rem;
        color: #6b7280;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
      }

      /* Loading dots */
      .dot {
        width: 6px;
        height: 6px;
        background: var(--emerald-500);
        border-radius: 50%;
        animation: dot-pulse 1.4s ease-in-out infinite;
      }

      .dot:nth-child(2) { animation-delay: 0.2s; }
      .dot:nth-child(3) { animation-delay: 0.4s; }

      @keyframes dot-pulse {
        0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
        40% { transform: scale(1); opacity: 1; }
      }

      /* Clouds */
      .cloud {
        position: absolute;
        opacity: 0.4;
        animation: cloud-float 6s ease-in-out infinite;
      }

      .cloud:nth-child(2) { animation-delay: 2s; opacity: 0.3; }
      .cloud:nth-child(3) { animation-delay: 4s; opacity: 0.2; }

      @keyframes cloud-float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-8px); }
      }
    </style>
  </head>
  <body>
    <!-- Instant loading screen - shows before JS loads -->
    <div id="initial-loader">
      <div class="loader-scene">
        <!-- Clouds -->
        <svg class="cloud" style="top: 10px; left: 20px;" width="60" height="30" viewBox="0 0 60 30">
          <ellipse cx="30" cy="18" rx="25" ry="12" fill="white"/>
          <ellipse cx="18" cy="15" rx="15" ry="10" fill="white"/>
          <ellipse cx="42" cy="15" rx="15" ry="10" fill="white"/>
        </svg>
        <svg class="cloud" style="top: 20px; right: 30px;" width="50" height="25" viewBox="0 0 50 25">
          <ellipse cx="25" cy="15" rx="20" ry="10" fill="white"/>
          <ellipse cx="15" cy="12" rx="12" ry="8" fill="white"/>
        </svg>
        <svg class="cloud" style="top: 5px; left: 50%;" width="40" height="20" viewBox="0 0 40 20">
          <ellipse cx="20" cy="12" rx="16" ry="8" fill="white"/>
        </svg>

        <!-- Grass -->
        <div class="loader-grass"></div>

        <!-- Road -->
        <div class="loader-road"></div>

        <!-- Truck -->
        <div class="loader-truck-container">
          <div class="loader-truck">
            <svg width="80" height="50" viewBox="0 0 80 50">
              <!-- Exhaust puffs -->
              <circle class="exhaust" cx="5" cy="32" r="4" fill="#d1d5db"/>
              <circle class="exhaust" cx="0" cy="28" r="3" fill="#e5e7eb"/>
              <circle class="exhaust" cx="8" cy="25" r="2.5" fill="#f3f4f6"/>

              <!-- Shadow -->
              <ellipse cx="40" cy="48" rx="32" ry="3" fill="rgba(0,0,0,0.15)"/>

              <!-- Truck body -->
              <rect x="12" y="14" width="40" height="24" rx="3" fill="#10b981"/>
              <rect x="14" y="16" width="36" height="4" rx="2" fill="rgba(255,255,255,0.3)"/>

              <!-- Recycling symbol -->
              <circle cx="32" cy="28" r="6" fill="rgba(255,255,255,0.2)"/>
              <text x="32" y="31" font-size="8" fill="rgba(255,255,255,0.5)" text-anchor="middle">â™»</text>

              <!-- Cabin -->
              <path d="M52 14h16a4 4 0 014 4v18a2 2 0 01-2 2H52V14z" fill="#059669"/>
              <path d="M52 14h16a4 4 0 014 4v3H52V14z" fill="#047857"/>

              <!-- Window -->
              <rect x="56" y="18" width="10" height="8" rx="2" fill="#60a5fa"/>
              <rect x="57" y="19" width="3" height="5" rx="1" fill="#93c5fd"/>

              <!-- Headlight -->
              <circle cx="70" cy="32" r="2.5" fill="#fef3c7"/>
              <circle cx="70" cy="32" r="1.5" fill="#fde68a"/>

              <!-- Front wheel -->
              <g class="wheel" style="transform-origin: 60px 42px;">
                <circle cx="60" cy="42" r="6" fill="#1f2937"/>
                <circle cx="60" cy="42" r="4" fill="#374151"/>
                <circle cx="60" cy="42" r="2" fill="#6b7280"/>
                <rect x="59" y="37" width="2" height="10" fill="#4b5563"/>
              </g>

              <!-- Back wheel -->
              <g class="wheel" style="transform-origin: 24px 42px;">
                <circle cx="24" cy="42" r="6" fill="#1f2937"/>
                <circle cx="24" cy="42" r="4" fill="#374151"/>
                <circle cx="24" cy="42" r="2" fill="#6b7280"/>
                <rect x="23" y="37" width="2" height="10" fill="#4b5563"/>
              </g>

              <!-- Lid -->
              <rect x="10" y="10" width="44" height="4" rx="2" fill="#6ee7b7"/>
              <rect x="26" y="6" width="12" height="4" rx="2" fill="#34d399"/>

              <!-- Emails in back -->
              <rect x="18" y="20" width="10" height="7" rx="1" fill="#818cf8"/>
              <path d="M18 21l5 3 5-3" stroke="#fff" stroke-width="1" fill="none"/>
              <rect x="30" y="21" width="8" height="6" rx="1" fill="#a78bfa"/>
              <rect x="40" y="20" width="7" height="5" rx="1" fill="#c4b5fd"/>
            </svg>
          </div>
        </div>
      </div>

      <div class="loader-text">
        <h1 class="loader-title">Hauling your emails</h1>
        <p class="loader-subtitle">
          Loading
          <span class="dot"></span>
          <span class="dot"></span>
          <span class="dot"></span>
        </p>
      </div>
    </div>

    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>

    <script>
      // Hide initial loader once Svelte app is ready
      window.hideInitialLoader = function() {
        const loader = document.getElementById('initial-loader');
        if (loader) {
          loader.classList.add('fade-out');
          setTimeout(() => loader.remove(), 300);
        }
      };
    </script>
  </body>
</html>
